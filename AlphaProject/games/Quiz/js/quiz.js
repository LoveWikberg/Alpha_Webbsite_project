var questions = [
{
question: "Which Turkish city has the name of a cartoon character? ",
answer: "Batman",
choice: ["Batman", "Gu'lachmet", "Ful al Shem", "Demir"],
},
{
question: "Which is the largest state of the United States?",
answer: "Alaska",
choice: [ "California", "Alaska", "Texas", "North Dakota"],
},
{
question: "What is the second largest country in Europe after Russia?",
answer: "France",
choice: [ "Germany", "France", "Ukrain", "Poland"],
},
{
question: "What is the first book of the Old Testament?",
answer: "Genesis",
choice: ["The protocanonials","Apocrypha","Judas","Genesis"],
},
{
question: "In which English town did Adolf Hitler study art?",
answer: "Liverpool",
choice: ["London","Brighton","Manchester","Liverpool","North Hampton"],
},
{
question: "Who did paint the famous painting Guernica?",
answer: "Pablo Picasso",
choice: ["Leonardo Da Vinci","Pablo Picasso","Silvio Berlusconi","Claudio Marchisio"],
},
{
question: "In which city did Romeo and Julia live?",
answer: "Verona",
choice: ["Verona","Palermo","Florence","Naples", "Bologna"],
},

{
question: 'In which italian city is Juventus FCs home ground, "Juventus Stadium", located?',
answer: "Turin",
choice: ["Bologna","Rome","Florence","Turin", "Milano"],
},
{
question: "In 2006, during the football world cup, Zinedine Zidane was sent of for head butting another player. Who was it?",
answer: "Marco Materazzi",
choice: ["Ronaldo","John Terry","Marco Materazzi","Andrea Pirlo", "Paolo Maldini"],
},
{
question: "How many Grand Slam titles have Roger Federer won?",
answer: "18",
choice: ["10","12","14","16", "18"],
},
{
question: "Which singer joined Mel Gibson in the movie Mad Max: Beyond The Thunderdome?",
answer: "Tina Turner",
choice: ["Tina Turner","Cher","Nancy Sinatra","Bonnie Tyler"],
},
{
question: "Vodka, Galliano and orange juice are used to make which classic cocktail?",
answer: "Harvey Wallbanger",
choice: ["French 75","Screwdriver","Classic Mimosa","Harvey Wallbanger"],
},
{
question: "On TV, who did the character Lurch work for?",
answer: "Addams family",
choice: ["Burns family","Addams family","The Wahlbergs","The Griffins", "The Cullen clan"],
},
{
question: "What is converted into alcohol during brewing?",
answer: "Sugar",
choice: ["Nitrogen","Hop","Malt","Salt", "Sugar"],
},
{
question: "Which river forms the eastern section of the border between England and Scotland?",
answer: "Tweed",
choice: ["Tweed","Thames","Hudson","Blerch"],
},
{
question: "Name the two families in Romeo and Juliet?",
answer: "Montague & Capulet",
choice: ["Lauren & Capulet","Montague & Capulet","Montague & Lauren","Lauren & Babineaux"],
},
{
question: "For which fruit is the US state of Georgia famous?",
answer: "Peach",
choice: ["Pineapple","Mango","Peach","Apricot","Orange"],
},
{
question: "In which city was Martin Luther King assassinated in 1968?",
answer: "Memphis, Tennessee",
choice: ["Portland, Oregon","St.George, Utah","Memphis, Tennessee"],
},
{
question: "In which country did the Mau Mau uprising (1952-60) occur?",
answer: "Kenya",
choice: ["Kenya","China","Botswana", "Vietnam", "Belize"],
},
{
question: "What does a numismatist study or collect?",
answer: "Coins",
choice: ["Stamps","Antiques","Dolls", "Coins"],
},
{
question: "Which guitarist is known as Slowhand?",
answer: "Eric Clapton",
choice: ["Yngwie Malmsteen","Santana","Jimi Hendrix", "Eric Clapton", "Les Paul"],
},
{
question: "Which is the capital of India?",
answer: "New Delhi",
choice: ["Bangladesh","Bombay","Calcutta", "New Delhi"],
},
{
question: "In which film did Roger Moore first play James Bond?",
answer: "Live and let die",
choice: ["Live and let die","The spy who loved me","Moonraker", "Diamonds are forever"],
},
{
question: "In which bay is Alcatraz?",
answer: "San Francisco bay",
choice: ["Santa Monica bay","Monterey bay","Alamitos bay", "San Francisco bay", "San Diego bay"],
},
{
question: "The Merseyside derby is a derby between which two football teams in the Barcleys Premier League?",
answer: "Everton & Liverpool",
choice: ["Liverpool & Manchester United","Everton & Liverpool","Arsenal & Liverpool", "Liverpool & Newcastle"],
},
{
question: "Who had a 1985 hit with Saving All My Love For You?",
answer: "Whitney Houston",
choice: ["Dolly Parton","Whitney Houston","Celine Dion"],
},
{
question: "In Roman mythology, Neptune is the equivalent to which Greek god?",
answer: "Poseidon",
choice: ["Poseidon","Ares","Hades","Zeus","Hermes"],
},
{
question: "Which of the answers is >NOT< a titan in the Greek mythology?",
answer: "Eros",
choice: ["Cronos","Theia","Oceanus","Atlas","Eros"],
},
{
question: "Complete the name of the American Football team: 'Washington ...........'?",
answer: "Redskins",
choice: ["Choose an answer","Penguins","Whitecaps","Redskins","Panthers","Capitals"],
},
{
question: "What is Canada's national animal?",
answer: "Beaver",
choice: ["Beaver","Brown bear","Carcajou","Bald Eagle"],
},
{
question: "Name the largest freshwater lake in the world?",
answer: "Lake Superior",
choice: ["Caspian Sea","Lake Victoria","Lake Tanganyika","Lake Superior"],
},
{
question: 'In the movie "Star Wars: The Force Awakens" Han Solo is killed by his son whose name is...?',
answer: "Kylo Ren",
choice: ["Rey", "Snoke", "Kylo Ren", "General hux", "Darth Maul", "Anakin Skywalker"],
},
{
question: "What kind of weapon is a falchion?",
answer: "Sword",
choice: ["Rifle","Catapult","Sword"],
},
{
question: "Name the seventh planet from the sun.",
answer: "Uranus",
choice: ["Neptune","Jupiter","Earth","Uranus","Saturn"],
},
{
question: "Who is this?",
picture: "img/GwynethPaltrow.jpg",
answer: "Gwyneth Paltrow",
choice: ["Jessica Simpson","Elizabeth Hurley","Mandy Moore","Gwyneth Paltrow","Chrissy Teigen"],
},
{
question: "What's the name of this building?",
picture: "img/tajMahal.jpg",
answer: "Taj Mahal",
choice: ["SacrÃ©-Coeur", "Hagia Sophia", "Taj Mahal", "Mahabat Maqbara"],
},
{
question: "Who's this?",
picture: "img/liamHemsworth.jpg",
answer: "Liam Hemsworth",
choice: [ "Liam Hemsworth", "Ashton Kutcher", "Channing Tatum", "Ian Somerhalder"],
},
{
question: "What car is this?",
picture: "img/camaro.jpg",
answer: "Chevrolet Camaro",
choice: ["Ford GT", "Pontiac Firebird", "Ford Mustang", "Chevrolet Camaro"],
},
{
question: "Which company has this logo?",
picture: "img/motorola.jpg",
answer: "Motorola",
choice: ["Move", "Motorola", "Migros", "Marley", "Mazda"],
},
{
question: "What are these nuts called?",
picture: "img/hazelnuts.jpg",
answer: "Hazelnuts",
choice: ["Walnuts", "Chestnuts", "Pecans", "Macadamia nuts", "Hazelnuts"],
},
{
question: "In which country are these twin towers located?",
picture: "img/petronas.jpg",
answer: "Malaysia",
choice: ["Kuala Lumpur", "Malaysia", "Hong Kong", "Beijing", "Singapore"],
},
];

var resetQuestions = [];

var beforePlayersSet = [
{
name: "",
points: 0,
question: [],
correct: [],
answer: [],
},
{
name: "",
points: 0,
question: [],
correct: [],
answer: [],
},
{
name: "",
points: 0,
question: [],
correct: [],
answer: [],
},
{
name: "",
points: 0,
question: [],
correct: [],
answer: [],
},
];
var playersArray = [];
var numberOfPlayers;

var playerTurn = 0;
var questionCounter = 0;
var questionsPerPlayer = 0;

function getNumberOfPlayers(){
	var html = '<form name="registrationForm">';
	html += "<p>Number of players</p>"
	html += '<input type="range" id="numPlayers" value="1" min="1" onchange="playernames()" max="4" oninput="numPlayersOutput.value = numPlayers.value">';
	html += '<output id="numPlayersOutput">1</output>';
	html += "<p>Number of questions per player</p>"
	html += '<input type="range" id="numberOfQuestions" value="5" min="1" max="10" oninput="numberOfQuestionsOutput.value = numberOfQuestions.value">';
	html += '<output id="numberOfQuestionsOutput">5</output>';
	html += '</form>';
	document.getElementById("printRange").innerHTML = html;
	playernames();
	document.getElementById("start").style.visibility = "hidden";

}

function playernames(){ 
	numberOfPlayers = document.getElementById("numPlayers").value;
	var html = "<p>Set player names</p>";
	for(var i=0; i < numberOfPlayers; i++){
		html += '<input type="text" placeholder="Player' +(i+1).toString()+' name" id="'+i.toString()+'"><br>';
	}
	html += '<input type="button" class="buttonDesign" value="Start" onclick="namesToArray()">';
	document.getElementById("printPlayerTextInput").innerHTML = html;
}

function namesToArray(){
	questionsPerPlayer = document.getElementById("numberOfQuestions").value;
	playersArray = [];
	for(var i=0; i < numberOfPlayers; i++){
	var getName = document.getElementById(i).value;
	beforePlayersSet[i].name = getName;
	beforePlayersSet[i].points = 0;
	beforePlayersSet[i].print = true;
	beforePlayersSet[i].question = [];
	beforePlayersSet[i].answer = [];
	beforePlayersSet[i].correct = [];
	playersArray.push(beforePlayersSet[i]);
	}
	
	document.getElementById('printRange').innerHTML = "<p></p>";
	document.getElementById('printPlayerTextInput').innerHTML = "<p></p>";
	startGame();
}

function resetAllValues(){
	questions = [];
	for(var i=0; i < resetQuestions.length; i++)
	{
		questions.push(resetQuestions[i]);
	}	
	document.getElementById("printQuestion").innerHTML = "<p></p>";
    playerTurn = 0;
    questionCounter = 0;
}

function playAgain(){
	document.getElementById("printKey").innerHTML = "<p></p>";
	resetAllValues();
	getNumberOfPlayers();
}


function progressBar(){
	var numberOfQuestions = (playersArray.length*questionsPerPlayer);
	var html = "";
	html+= '<div id="myProgress">';
	html+= '<div id="myBar">';
    html+= '<div id="label">'+questionCounter+'/'+numberOfQuestions+'</div>';
	html+= '</div>';
	html+= '</div>';
	return html;
}

function startGame(){
	for(var i=0; i < questions.length; i++)
	{
		resetQuestions.push(questions[i]);
	}
	gameCycle();
}

function gameCycle(){
	var html = progressBar();
	/*html += "<p>Points</p>";
	html += "<h3>";
	for(var i=0; i < playersArray.length; i++){
		html += "<score>" + playersArray[i].name + ": " + playersArray[i].points + " </score>";
		document.getElementById("printQuestion").innerHTML = html;
	}
	html += "</h3>";*/
	
	if(questionCounter < (playersArray.length*questionsPerPlayer))
	{	
		if(playersArray.length > 1)
		html += "<p><mark><b>" + playersArray[playerTurn].name + ", it's your turn!</b></mark></p><br>";
		
		var randomNumber = Math.floor((Math.random() * questions.length) + 1);	
		randomNumber -= 1;		
		html += printQuestion(randomNumber);		
		html += '<br>' + '<input type="button" class="buttonDesign" value="Next" onclick="calculatePoints('+randomNumber+')"<br></input>';
		document.getElementById("printQuestion").innerHTML = html;
		var percentProgress = ((questionCounter) / (playersArray.length*questionsPerPlayer))*100;
		document.getElementById("myBar").style.width = percentProgress+"%"
	}
	else
	{	
		var	pointArray = [];
		for(var x=0; x < playersArray.length; x++){
			pointArray[x] = playersArray[x].points;
		}		
		var largest = Math.max.apply( Math, pointArray );
		pointArray.sort();
		
		var gameEnd = "";
		
		if(playersArray.length == 1){
				var percent = convertToPercent(0);
				gameEnd += "<p>Points: " + playersArray[0].points+ "/"+questionsPerPlayer+"</p>";
				gameEnd += '<p>You got '+percent.toString()+'% of the answers right.</p><input type="button" value="Show answers" onclick="printKey(0)"</input>';
		}
		else
		{	
			if(pointArray[(pointArray.length-1)] == pointArray[(pointArray.length-2)]){
				gameEnd = "<h3> It's a draw! </h3><br>";
			}			
			else
			{		
				for(var i=0; i < playersArray.length; i++){
					if (playersArray[i].points === largest)
					{	
					gameEnd = "<h3>" +playersArray[i].name+ " wins!!!</h3><br>";
					break;
					}
				}
			}
			var ind = playersArray.length;
			while(ind != 0)
			{
				for(var i=0; i < playersArray.length; i++){
					//playersArray.print is used avoid printing the same player several times.
					if(playersArray[i].points == pointArray[(ind-1)] && playersArray[i].print == true){
						playersArray[i].print = false;
						var percent = convertToPercent(i);
						gameEnd += '<p>' +playersArray[i].name+ '    Points: ' + playersArray[i].points+ '/'+questionsPerPlayer+' ('+percent+'%)</p><input type="button" value="Show answers" onclick="printKey('+i+')"</input>';
					}
				}
				ind-=1;
			}
		}
		
		gameEnd += '<br><br><input type="button" class="buttonDesign" value="Play again" onclick="playAgain()"></input>'
		document.getElementById("printQuestion").innerHTML = gameEnd;
	}
}

function printKey(index){
	html = "";
	for(var i=0; i < playersArray[index].question.length; i++){
			html += "<hr><p>" +playersArray[index].question[i]+"</p>";
			html += "<p>Correct answer: " +playersArray[index].correct[i]+"</p>";
			html += "<p>Your answer: " +playersArray[index].answer[i]+"</p>";
		}
	document.getElementById("printKey").innerHTML = html;
}

function printQuestion(index){
	
	var html = "<p><b>" + questions[index].question + "</b></p>";
	
	if(questions[index].picture != null){
		html += '<div class="dropdown">';
		html += '<img src="'+questions[index].picture.toString()+'" alt="ERROR - picture not found" style="width:250px;height:170px;"><br>';
		html += '<div class="dropdown-content">';
		html += '<img src="'+questions[index].picture.toString()+'" style = "width:400px;height:300px;">';
		html += '</div>';
		html += '</div>';
	}
	
	html += '<select text="hej" id="answer">';
	html += '<option>Choose an answer</option>';
	for(var x=0; x < questions[index].choice.length; x++){
		html += '<option value="' +questions[index].choice[x]+ '" >' +questions[index].choice[x]+ '</option>' 
	}
	html += "</select><br>";
	return html;
}

function calculatePoints(index){
	var value = document.getElementById("answer").value;
	if(value == questions[index].answer)
	{
		playersArray[playerTurn].points += 1;
	}
	playersArray[playerTurn].question.push(questions[index].question);
	playersArray[playerTurn].correct.push(questions[index].answer);
	playersArray[playerTurn].answer.push(value);
	
	if(playerTurn < (playersArray.length-1))
		playerTurn += 1;
	else if (playerTurn === (playersArray.length-1))
		playerTurn = 0;
	
	questions.splice(index,1);
	questionCounter += 1;
	gameCycle();
}

function convertToPercent(index){
	var percent = (playersArray[index].points / questionsPerPlayer) * 100;
				var percentToString = percent.toString().substring(0,4);
				return percentToString;
}